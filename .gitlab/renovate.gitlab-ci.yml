---
.renovate:
  stage: renovate
  image: renovate/renovate
  variables:
    RENOVATE_CONFIG_FILE: renovate.json
    RENOVATE_AUTODISCOVER: "true"
    RENOVATE_ONBOARDING: "false"
    RENOVATE_PLATFORM: gitlab
    RENOVATE_ENDPOINT: https://gitlab.com/api/v4/
    LOG_LEVEL: info
  script:
    - renovate
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: always
    - when: never
  allow_failure: true
  timeout: 2h

renovate:
  extends: .renovate
  variables:
    RENOVATE_SCHEDULE_NAME: "hourly"
