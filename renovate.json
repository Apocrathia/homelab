{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    "security:openssf-scorecard"
  ],
  "vulnerabilityAlerts": {
    "enabled": true
  },
  "pre-commit": {
    "enabled": true
  },
  "flux": {
    "enabled": true
  },
  "kubernetes": {
    "managerFilePatterns": ["/^flux/manifests/.*\\.yaml$/"]
  },
  "packageRules": [
    {
      "matchCategories": ["docker"],
      "enabled": true
    },
    {
      "matchUpdateTypes": ["minor", "patch"],
      "matchCurrentVersion": "!/^0/",
      "automerge": true,
      "automergeType": "pr",
      "platformAutomerge": true
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Talos Linux dependencies",
      "managerFilePatterns": ["/^talos/.*\\.yaml$/"],
      "datasourceTemplate": "github-releases",
      "matchStrings": [
        "# renovate: datasource=github-releases depName=(?<depName>siderolabs/talos)\\s*\\n\\s*image: .*:(?<currentValue>v\\d+\\.\\d+\\.\\d+)"
      ]
    },
    {
      "customType": "regex",
      "description": "Generic App Chart versions from Git tags",
      "managerFilePatterns": ["/^flux/manifests/.*\\.yaml$/"],
      "datasourceTemplate": "git-tags",
      "depNameTemplate": "generic-app",
      "matchStrings": [
        "# renovate: datasource=git-tags depName=https://gitlab.com/Apocrathia/homelab.git\\s*\\n\\s*version: [\"']?(?<currentValue>[^\"'\\s]+)[\"']?"
      ],
      "extractVersionTemplate": "^generic-app-(?<version>.*)$"
    },
    {
      "customType": "regex",
      "description": "Flux and other dependencies",
      "managerFilePatterns": ["/^flux/manifests/.*\\.yaml$/"],
      "matchStrings": [
        "apiVersion: (?<depName>apiextensions\\.k8s\\.io)/(?<currentValue>v1beta1)",
        "# renovate: datasource=docker depName=(?<depName>\\S+)\\s*\\n[\\s\\S]*?helper_image = [\"'][^:]+:(?<currentValue>[^\"'\\s]+)[\"']",
        "# renovate: datasource=github-releases depName=(?<depName>[^\\s]+)\\s*\\n[\\s\\S]*?https://github\\.com/[^/]+/[^/]+/releases/download/v(?<currentValue>[^/\\s]+)/[^\\s]*",
        "# renovate: datasource=github-tags depName=(?<depName>[^\\s]+)\\s*\\n[\\s\\S]*?https://raw\\.githubusercontent\\.com/[^/]+/[^/]+/(?<currentValue>[^/\\s]+)/[^\\s]+",
        "# renovate: datasource=(?<datasource>\\S+) (?:registryUrl=(?<registryUrl>\\S+) )?depName=(?<depName>\\S+)\\s*\\n\\s*version: [\"']?(?<currentValue>[^\"'\\s]+)[\"']?",
        "# renovate: datasource=(?<datasource>\\S+) (?:registryUrl=(?<registryUrl>\\S+) )?depName=(?<depName>\\S+)\\s*\\n\\s*image: [\"']?(?<currentValue>[^\"'\\s]+)[\"']?"
      ]
    }
  ],
  "timezone": "America/Denver",
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "Dependencies Dashboard ðŸ¤–",
  "rangeStrategy": "replace",
  "semanticCommits": "enabled",
  "commitMessagePrefix": "chore(deps):",
  "rebaseWhen": "behind-base-branch",
  "platformAutomerge": true,
  "automergeType": "pr"
}
