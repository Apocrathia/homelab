---
apiVersion: toolhive.stacklok.dev/v1alpha1
kind: MCPServer
metadata:
  name: grafana-mcp
  namespace: mcp-grafana
  labels:
    app.kubernetes.io/name: grafana-mcp
    app.kubernetes.io/component: mcp-server
    app.kubernetes.io/part-of: artificial-intelligence
    app.kubernetes.io/managed-by: flux
  annotations:
    description: "Grafana MCP server for AI assistant integration"
spec:
  # renovate: datasource=docker registryUrl=https://docker.io depName=grafana/mcp-grafana
  image: docker.io/grafana/mcp-grafana:0.7.10
  transport: streamable-http
  port: 8080
  targetPort: 8080
  permissionProfile:
    type: builtin
    name: network
  env:
    # Default Grafana URL (can be overridden via X-Grafana-URL header)
    - name: GRAFANA_URL
      value: "https://grafana.gateway.services.apocrathia.com"
      # Token passed via X-Grafana-API-Key header from client through LiteLLM
  args:
    - -t
    - streamable-http
    - --address
    - "0.0.0.0:8080"
    - --debug
  resources:
    limits:
      cpu: "200m"
      memory: "256Mi"
    requests:
      cpu: "100m"
      memory: "128Mi"
