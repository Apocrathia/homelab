# Mealie

Mealie is a self-hosted recipe manager and meal planning application designed to streamline cooking and meal preparation workflows.

- **GitHub**: [mealie-recipes/mealie](https://github.com/mealie-recipes/mealie)
- **Documentation**: [docs.mealie.io](https://docs.mealie.io/)

## Overview

Mealie provides comprehensive recipe management, meal planning, shopping list generation, and data organization capabilities through a modern web interface.

## Access

- **URL**: https://mealie.gateway.services.apocrathia.com
- **Authentication**: OIDC via Authentik

## Features

- **Recipe Management**: Import recipes from URLs using built-in scraper
- **Meal Planning**: Create meal plans for week, month, or year with calendar view
- **Shopping Lists**: Generate and manage shopping lists from meal plans
- **Multi-user Support**: Full group/household sharing capabilities
- **Rich UI**: Beautiful interface with markdown recipe editor
- **API Driven**: Full REST API with interactive documentation
- **Backups**: Automatic backups with Jinja2 template support
- **Webhooks**: Schedule notifications to 3rd party services

See the [official documentation](https://docs.mealie.io/) for complete feature details.

## Configuration

### Storage

- **Type**: Longhorn persistent storage
- **Capacity**: 20Gi
- **Mount Path**: `/app/data`

### Database

- **Engine**: PostgreSQL 16 (CloudNativePG)
- **Storage**: 10Gi Longhorn persistent volume
- **Credentials**: Managed via 1Password Connect
- **Connection**: Internal Kubernetes service (`mealie-postgres-rw.mealie.svc.cluster.local`)

### Environment

Mealie is almost entirely configured through environment variables. See the [Backend Configuration](https://docs.mealie.io/documentation/getting-started/installation/backend-config/) documentation for complete details.

#### Core Configuration

- **BASE_URL**: External access URL for proper functionality
- **OIDC_ENABLED**: OIDC authentication enabled
- **OIDC_CLIENT_ID/SECRET**: Authentik OIDC credentials
- **ALLOW_PASSWORD_LOGIN**: Disabled when OIDC is enabled

For OIDC configuration details, see the [OpenID Connect documentation](https://docs.mealie.io/documentation/getting-started/authentication/oidc-v2/).

#### Database Configuration

- **DB_ENGINE**: Database engine (`postgres` for PostgreSQL, `sqlite` for SQLite)
- **POSTGRES_SERVER**: PostgreSQL server hostname
- **POSTGRES_USER**: PostgreSQL username
- **POSTGRES_PASSWORD**: PostgreSQL password
- **POSTGRES_DB**: PostgreSQL database name
- **POSTGRES_PORT**: PostgreSQL port (default: 5432)

#### SMTP Email Configuration

Mealie requires SMTP configuration for email functionality (notifications, password resets, etc.):

- **SMTP_HOST**: SMTP server hostname
- **SMTP_PORT**: SMTP server port (default: 587)
- **SMTP_FROM_NAME**: Sender name for emails (default: "Mealie")
- **SMTP_FROM_EMAIL**: Sender email address
- **SMTP_AUTH_STRATEGY**: Authentication strategy (TLS, SSL, NONE) (default: TLS)
- **SMTP_USER**: SMTP username
- **SMTP_PASSWORD**: SMTP password

**Note**: All sensitive configuration values are managed via 1Password Connect and stored in the `mealie-secrets` secret.

### Security

- OIDC authentication via Authentik
- Password login disabled when OIDC is enabled

## Initial Setup

1. Access Mealie at https://mealie.gateway.services.apocrathia.com
2. Login via OIDC using your Authentik credentials
3. Navigate to `/admin/site-settings` to verify configuration
4. Configure additional settings as needed

## OIDC Authentication Setup

To retrieve OIDC client credentials from Authentik:

```bash
kubectl get secret mealie-secrets -n mealie -o jsonpath='{.data.oidc-client-id}' | base64 -d
kubectl get secret mealie-secrets -n mealie -o jsonpath='{.data.oidc-client-secret}' | base64 -d
```

These credentials are automatically generated by the Authentik blueprint and stored in the `mealie-secrets` secret.
