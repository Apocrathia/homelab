---
# Remove auto hostname config to allow static hostname
apiVersion: v1alpha1
kind: HostnameConfig
$patch: delete
---
# yaml-language-server: $schema=https://raw.githubusercontent.com/siderolabs/talos/v1.11.3/pkg/machinery/config/schemas/config.schema.json
machine:
  nodeLabels:
    # https://www.robert-jensen.dk/posts/2025-loadbalancer-not-working-on-single-node-talos-cluster/
    node.kubernetes.io/exclude-from-external-load-balancers: ""
    $patch: delete
  network:
    hostname: talos-01
    interfaces:
      - interface: eth0
        addresses:
          - 10.100.1.80/24
        routes:
          - network: 0.0.0.0/0
            gateway: 10.100.1.1
  certSANs:
    - "10.100.1.80"
    - "10.100.1.8"
    - "talos-01.apocrathia.com"
    - "talos-01.services.apocrathia.com"
    - "kubernetes.apocrathia.com"
    - "127.0.0.1"
